@{
    ViewData["Title"] = "AddLeaveType";

    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

@{
    ViewData["Title"] = "ApplyLeave";

    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<style>
    .page-heading {
        color: #007bff;
        text-align: center;
        font-weight: bold;
        text-transform: uppercase;
        border-bottom: 2px solid #007bff;
        padding-bottom: 10px;
        margin-bottom: 5px;
        font-family: Arial, sans-serif;
    }

    h3 {
        font-size: 1.5rem;
    }
</style>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
<div class="container mt-4">
    <h3 class="page-heading">Apply Leave</h3>
    <div class="form-container">
        <div class="card p-4">
            <form id="applyLeaveForm">
                <div class="row">
                    <!-- Employee Name (First Column) -->
                    <div class="col-md-4 mb-3">
                        <label for="EmployeeName" class="form-label">Employee Name * :</label>
                        <select class="form-control" id="EmployeeName" name="EmployeeName" required>
                            <option value="">Select Employee</option>
                            <option value="John Doe">John Doe</option>
                            <option value="Jane Smith">Jane Smith</option>
                            <option value="Michael Brown">Michael Brown</option>
                            <!-- Add more employees dynamically -->
                        </select>
                    </div>

                    <!-- Leave Type (Second Column) -->
                    <div class="col-md-4 mb-3">
                        <label for="LeaveType" class="form-label">Leave Type * :</label>
                        <select class="form-control" id="LeaveType" name="LeaveType" required>
                            <option value="">Select leave type</option>
                            <option value="Sick Leave">Sick Leave</option>
                            <option value="Casual Leave">Casual Leave</option>
                            <option value="Vacation Leave">Vacation Leave</option>
                            <!-- Add more leave types as needed -->
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <!-- Holiday Date -->
                        <div class="form-group">
                            <label for="ChooseDate"> Date </label>
                            <input type="text" class="form-control datepicker" id="ChooseDate" name="chooseDate" placeholder="Select a date" required>
                        </div>
                    </div>

                </div>

                <div class="row">
                    <!-- Employee Post (First Column) -->
                    <div class="col-md-6 mb-3">
                        <label for="EmployeePost" class="form-label">Employee Post * :</label>
                        <select class="form-control" id="EmployeePost" name="EmployeePost" required>
                            <option value="">Select Employee Post</option>
                            <option value="Manager">Manager</option>
                            <option value="Developer">Developer</option>
                            <option value="HR">HR</option>
                            <!-- Add more employee posts as needed -->
                        </select>
                    </div>

                    <!-- Department Name (Second Column) -->
                    <div class="col-md-6 mb-3">
                        <label for="DepartmentName" class="form-label">Department Name * :</label>
                        <select class="form-control" id="DepartmentName" name="DepartmentName" required>
                            <option value="">Select Department</option>
                            <option value="HR">HR</option>
                            <option value="IT">IT</option>
                            <option value="Finance">Finance</option>
                            <!-- Add more departments as needed -->
                        </select>
                    </div>
                </div>

                <div class="row">
                    <!-- Leave From Date (First Column) -->
                    <div class="col-md-4 mb-3">
                        <label for="LeaveFrom" class="form-label">Leave From * :</label>
                        <input type="text" class="form-control datepicker" id="LeaveFrom" name="LeaveFrom" placeholder="Leave From" required>
                    </div>

                    <!-- Leave To Date (Second Column) -->
                    <div class="col-md-4 mb-3">
                        <label for="LeaveTo" class="form-label">Leave To * :</label>
                        <input type="text" class="form-control datepicker" id="LeaveTo" name="LeaveTo" placeholder="Leave To" required>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="TotalDays" class="form-label">Total Days * :</label>
                        <input type="number" class="form-control" id="TotalDays" name="TotalDays" readonly required>
                    </div>
                </div>

                <div class="row">
                    <!-- File Upload (Second Column, Hidden by Default) -->
                    <div class="col-md-6 mb-3" id="sickLeaveFileUpload" style="display:none;">
                        <label for="SickLeaveFile" class="form-label">Upload Sick Leave Document (Optional) :</label>
                        <input type="file" class="form-control" id="SickLeaveFile" name="SickLeaveFile" accept=".docx, .pdf" />
                    </div>
                </div>

                <div class="row">
                    <!-- Description (Full Width) -->
                    <div class="col-md-6 mb-3">
                        <label for="Description" class="form-label">Description * :</label>
                        <textarea class="form-control" id="Description" name="Description" rows="4" placeholder="Enter your reason for leave" required></textarea>
                    </div>
                </div>

                <!-- Submit and Reset Buttons -->
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <button type="submit" class="btn btn-success">Apply Leave</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- Leave Applications List -->

    <div class="container mt-4">
        <h4>Leave Application Details</h4>
        <div class="table-responsive">
            <table id="LeaveApplicationTable" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Employee Name</th>
                        <th>Leave Type</th>
                        <th>Department</th>
                        <th>Leave From</th>
                        <th>Leave To</th>
                        <th>File</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Sample Data (This can be dynamically generated from a backend) -->
                    <tr>
                        <td>1</td>
                        <td>John Doe</td>
                        <td>Sick Leave</td>
                        <td>HR</td>
                        <td>2025-01-10</td>
                        <td>2025-01-12</td>
                        <td><a href="#">View File</a></td>
                        <td>
                            <!-- Actions (e.g., Edit/Delete) -->
                            <button class="btn btn-primary">Edit</button>
                            <button class="btn btn-danger">Delete</button>
                        </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Jane Smith</td>
                        <td>Casual Leave</td>
                        <td>IT</td>
                        <td>2025-01-15</td>
                        <td>2025-01-16</td>
                        <td>-</td>
                        <td>
                            <!-- Actions (e.g., Edit/Delete) -->
                            <button class="btn btn-primary">Edit</button>
                            <button class="btn btn-danger">Delete</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
    // Initialize datepickers
    $('#ChooseDate, #LeaveFrom, #LeaveTo').datepicker({
        changeMonth: true,
        changeYear: true,
        yearRange: '1950:2070',
        dateFormat: 'dd-MM-yy',
        minDate: '0',  // Disable past dates
        defaultDate: new window.Date()
    });

    // Show/Hide file upload based on leave type selection
    document.getElementById('LeaveType').addEventListener('change', function() {
        const leaveType = this.value;
        const sickLeaveFileUpload = document.getElementById('sickLeaveFileUpload');

        if (leaveType === 'Sick Leave') {
            sickLeaveFileUpload.style.display = 'block';
        } else {
            sickLeaveFileUpload.style.display = 'none';
        }
    });

        // Add event listeners to handle changes on both 'Leave From' and 'Leave To'
    document.getElementById('LeaveFrom').addEventListener('change', handleLeaveDateChange);
    document.getElementById('LeaveTo').addEventListener('change', handleLeaveDateChange);

    function handleLeaveDateChange() {
        const leaveFrom = document.getElementById('LeaveFrom').value;
        const leaveTo = document.getElementById('LeaveTo').value;

        // If both dates are filled
        if (leaveFrom && leaveTo) {
            const startDate = new Date(leaveFrom);
            const endDate = new Date(leaveTo);

            // Validate that 'Leave From' date is before 'Leave To' date
            if (startDate > endDate) {
                alert('Leave From date must be before Leave To date.');
                document.getElementById('LeaveFrom').value = '';  // Clear 'Leave From' date
                document.getElementById('LeaveTo').value = '';    // Clear 'Leave To' date
                document.getElementById('TotalDays').value = '';  // Clear 'Total Days'
            } else {
                // Calculate total days if dates are valid
                const timeDifference = endDate - startDate;
                const totalDays = timeDifference / (1000 * 3600 * 24) + 1; // Adding 1 to include the start date
                document.getElementById('TotalDays').value = totalDays;  // Display total days
            }
        } else {
            document.getElementById('TotalDays').value = totalDays;  // Clear total days if either date is missing
        }
    }
</script>


