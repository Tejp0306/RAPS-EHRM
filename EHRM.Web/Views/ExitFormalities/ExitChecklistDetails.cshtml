
@{
    ViewData["Title"] = "ExitChecklistDetails";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<style>
    .page-heading {
        color: #007bff;
        text-align: center;
        font-weight: bold;
        text-transform: uppercase;
        border-bottom: 2px solid #007bff;
        padding-bottom: 10px;
        margin-bottom: 20px;
        font-family: Arial, sans-serif;
    }

    .form-label {
        font-weight: bold;
    }

    .btn-custom {
        background-color: #007bff;
        color: white;
        border: none;
    }

        .btn-custom:hover {
            background-color: #0056b3;
        }

    .form-container {
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 8px;
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

<div class="container mt-4">
    <h3 class="page-heading">Exit Checklist Details</h3>
    <div class="table-responsive">
        <table id="exitChecklistFormTable1" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Employee Name</th>
                    <th>Last working Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <!-- Sample Data (Dynamically generated in backend) -->
                <tr>
                </tr>

            </tbody>
        </table>
    </div>
</div>

<div class="modal fade" id="exitChecklistModal" tabindex="-1" aria-labelledby="exitChecklistModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Exit Checklist</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post">
                    <div class="row">
                        <div class="mb-3 col-lg-6">
                            <label class="form-label">Name:</label>
                            <input id ="Name" type="text" class="form-control" value="@ViewData["Name"]" readonly />
                        </div>

                        <div class="mb-3  col-lg-6">
                            <label class="form-label">Emp. Id:</label>
                            <input id="EmpId" type="text" class="form-control" value="@ViewData["EmpId"]" readonly />
                        </div>
                    </div>
                    <div class="row">
                        <div class="mb-3 col-lg-6">
                            <label class="form-label">Date of Resignation/Termination:</label>
                            <input id="ResignationDate" type="date" class="form-control" readonly />
                        </div>
                        <div class="mb-3  col-lg-6">
                            <label class="form-label">Date of Relieving:</label>
                            <input id="RelievingDate" type="date" class="form-control" readonly />
                        </div>
                    </div>

                    <div class="row">
                        <div class="mb-3 col-lg-6">
                            <label class="form-label">Start Date:</label>
                            <input id="StartDate" type="date" class="form-control" readonly />
                        </div>

                        <div class="mb-3  col-lg-6">
                            <label class="form-label">Reporting Manager:</label>
                            <input id="ReportingManager" type="text" class="form-control" readonly />
                        </div>
                    </div>

                    <h4 class="text-primary">Reporting Manager</h4>
                    <table class="table table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>Task</th>
                                <th>Yes/No</th>
                                <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Has completed the tasks at hand</td>
                                <td>
                                    <select id="CompletedTasks" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="CompletedTasksRemarks" type="text" class="form-control" /></td>
                            </tr>
                            <tr>
                                <td>Has transferred the knowledge to the nominated colleague</td>
                                <td>
                                    <select id="KnowledgeTransfer" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="KnowledgeTransferRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Has returned all the assets assigned at the time of joining</td>
                                <td>
                                    <select id="AssetsReturned" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="AssetsReturnedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Has returned all the documents assigned at the time of joining</td>
                                <td>
                                    <select id="DocumentsReturned" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="DocumentsReturnedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Mail Forwarding required/to be assigned to</td>
                                <td>
                                    <select id="MailForwarding" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="MailForwardingRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Mail sent to HR on Emplyee's Last Working Day</td>
                                <td>
                                    <select id="MailSentToHR" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="MailSentToHRRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mb-3">
                        <label class="form-label">Signature of Reporting Manager:</label>
                        <input id="ReportingManager0" type="text" name="ReportingManagerSignature" class="form-control" readonly />
                    </div>

                    <h4 class="text-primary">IT Department</h4>
                    <table class="table table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>Task</th>
                                <th>Yes/No</th>
                                <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Login ID and Outlook ID withdrawn</td>
                                <td>
                                    <select id="LoginWithdrawn" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="LoginWithdrawnRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>JobDiva Password Reset</td>
                                <td>
                                    <select id="JobdivaReset" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="JobdivaResetRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Spectra Wi-Fi suspended</td>
                                <td>
                                    <select id="WifiSuspended" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="WifiSuspendedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Door Access Suspended</td>
                                <td>
                                    <select id="DoorAccess" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="DoorAccessRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>RingCentral Suspended</td>
                                <td>
                                    <select id="RingcentralSuspended" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="RingcentralSuspendedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>VOIP Phone Deactivated</td>
                                <td>
                                    <select id="VoipPhoneDeactivated" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="VoipPhoneDeactivatedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Client / Job Portal Passwords changed</td>
                                <td>
                                    <select id="ClientPasswordsChanged" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="ClientPasswordsChangedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mb-3">
                        <label class="form-label">Signature of HelpDesk Rep:</label>
                        <input id="HelpdeskSignature" type="text" name="HelpDeskSignature" class="form-control" readonly />
                    </div>

                    <h4 class="text-primary">Administration</h4>
                    <table class="table table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>Task</th>
                                <th>Yes/No</th>
                                <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Handed over the Photo Identity card and access card</td>
                                <td>
                                    <select id="IdCardReturned" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="IdCardReturnedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Name deleted from access control sent to HR</td>
                                <td>
                                    <select id="AccessControlUpdated" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="AccessControlUpdatedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Visa processing fee to be recovered</td>
                                <td>
                                    <select id="VisaFeeRecovery" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="VisaFeeRecoveryRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Company Transport discontinued</td>
                                <td>
                                    <select id="TransportDiscontinued" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="TransportDiscontinuedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>

                        </tbody>
                    </table>

                    <div class="mb-3">
                        <label class="form-label">Signature of Administrator:</label>
                        <input type="text" id="AdminSignature" class="form-control" readonly />
                    </div>

                    <h4 class="text-primary">Human Resources</h4>
                    <table class="table table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>Task</th>
                                <th>Yes/No</th>
                                <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Exit Interview conducted by HR and feedback received</td>
                                <td>
                                    <select id="ExitInterview" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="ExitInterviewRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Furnished F&F details to Payroll, including Gratuity if any</td>
                                <td>
                                    <select id="FAndFProcessed" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="FAndFProcessedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Any Training cost to be recovered</td>
                                <td>
                                    <select id="TrainingCost" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="TrainingCostRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Resignation details updated on HRIS/ attendance system</td>
                                <td>
                                    <select id="ResignationUpdated" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="ResignationUpdatedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Name, if to be removed from website</td>
                                <td>
                                    <select id="NameRemoved" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="NameRemovedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Discontinue Insurance benefit</td>
                                <td>
                                    <select id="InsuranceDiscontinued" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="InsuranceDiscontinuedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mb-3">
                        <label class="form-label">Signature of HR Manager:</label>
                        <input id="HrSignature" type="text" name="HRSignature" class="form-control" readonly />
                    </div>

                    <h4 class="text-primary">Accounts</h4>
                    <table class="table table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>Task</th>
                                <th>Yes/No</th>
                                <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Has returned the loans/ advance taken, if any.</td>
                                <td>
                                    <select id="LoansReturned" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="LoansReturnedRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Incentive / Bonus due to employee</td>
                                <td>
                                    <select id="IncentiveDue" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="IncentiveDueRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Deductions due from employee</td>
                                <td>
                                    <select id="DeductionsDue" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="DeductionsDueRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Amount due from overseas travel/visa processing fee</td>
                                <td>
                                    <select id="TravelFeeDue" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="TravelFeeDueRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Any Training cost to be recovered</td>
                                <td>
                                    <select id="TrainingCostDue" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="TrainingCostDueRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Visa processing fee to be recovered</td>
                                <td>
                                    <select id="VisaFeeDue" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="VisaFeeDueRemarks" type="text" class="form-control" readonly /></td>
                            </tr>
                            <tr>
                                <td>Any additional deductions / payments due to Employee</td>
                                <td>
                                    <select id="AdditionalDeductions" class="form-control">
                                        <option value="">Choose</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </td>
                                <td><input id="AdditionalDeductionsRemarks" type="text" class="form-control" readonly/></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mb-3">
                        <label class="form-label">Signature of Accounts Manager:</label>
                        <input id="AccountsManagerSignature" type="text" class="form-control" readonly />
                    </div>

                    <br />

                  
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button id="downloadExitChecklistBtn" class="btn btn-success">Download PDF</button>
            </div>
        </div>
    </div>
</div>

<script src="~/JsPDF/jspdf.js"></script>

<script>
            $(document).ready(function () {
        getExitChecklistDataDetail();
    });

    // Function to fetch Employee Undertaking data and populate the DataTable
    function getExitChecklistDataDetail() {
        $('#exitChecklistFormTable1').DataTable({
            destroy: true,
            ajax: {
                url: '/ExitFormalities/GetExitCkecklist',
                method: 'GET',
                dataSrc: ''
            },
            columns: [
                { data: 'name' },
                { data: 'reportingManager' },
                {
                    data: 'id',
                    render: function (data) {
                        return `
                            <div class="d-flex justify-content-center">
                                <button class="btn btn-info btn-sm mx-1 view-btn" data-id="${data}">
                                    <i class="bi bi-eye"></i> View & Download
                                </button>
                            </div>
                        `;
                    },
                    orderable: false
                }
            ],
            pageLength: 5,
            lengthMenu: [5, 10, 15, 20]
        });

        // Bind click event for dynamically added buttons
        $('#exitChecklistFormTable1 tbody').on('click', '.view-btn', function () {
            const id = $(this).data('id');
            openexitChecklistModal(id);
        });
    }

        // Function to open modal and fetch details
    function openexitChecklistModal(id) {
        $.ajax({
            url: `/ExitFormalities/GetExitCkecklistById/${id}`,
            method: 'GET',
            success: function (response) {
                if (response.success) {
                    console.log("API Response:", response);

                    const data = response.data.data || response.data;
                    debugger;
                        // Populate modal fields
    $('#Name').val(data.name);
    $('#EmpId').val(data.empId);
    $('#ResignationDate').val(data.resignationDate);
    $('#RelievingDate').val(data.relievingDate);
    $('#StartDate').val(data.startDate);
    $('#ReportingManager').val(data.reportingManager);
    $('#CompletedTasks').val(data.completedTasks);
    $('#CompletedTasksRemarks').val(data.completedTasksRemarks);
    $('#KnowledgeTransfer').val(data.knowledgeTransfer);
    $('#KnowledgeTransferRemarks').val(data.knowledgeTransferRemarks);
    $('#AssetsReturned').val(data.assetsReturned);
    $('#AssetsReturnedRemarks').val(data.assetsReturnedRemarks);
    $('#DocumentsReturned').val(data.documentsReturned);
    $('#DocumentsReturnedRemarks').val(data.documentsReturnedRemarks);
    $('#MailForwarding').val(data.mailForwarding);
    $('#MailForwardingRemarks').val(data.mailForwardingRemarks);
    $('#MailSentToHR').val(data.mailSentToHr);
    $('#MailSentToHRRemarks').val(data.mailSentToHrRemarks);
    $('#ReportingManager0').val(data.reportingManagerSignature);
    $('#LoginWithdrawn').val(data.loginWithdrawn);
    $('#LoginWithdrawnRemarks').val(data.loginWithdrawnRemarks);
    $('#JobdivaReset').val(data.jobdivaReset);
    $('#JobdivaResetRemarks').val(data.jobdivaResetRemarks);
    $('#WifiSuspended').val(data.wifiSuspended);
    $('#WifiSuspendedRemarks').val(data.wifiSuspendedRemarks);
    $('#DoorAccess').val(data.doorAccess);
    $('#DoorAccessRemarks').val(data.doorAccessRemarks);
    $('#RingcentralSuspended').val(data.ringcentralSuspended);
    $('#RingcentralSuspendedRemarks').val(data.ringcentralSuspendedRemarks);
    $('#VoipPhoneDeactivated').val(data.voipPhoneDeactivated);
    $('#VoipPhoneDeactivatedRemarks').val(data.voipPhoneDeactivatedRemarks);
    $('#ClientPasswordsChanged').val(data.clientPasswordsChanged);
    $('#ClientPasswordsChangedRemarks').val(data.clientPasswordsChangedRemarks);
    $('#HelpdeskSignature').val(data.helpdeskSignature);
    $('#IdCardReturned').val(data.idCardReturned);
    $('#IdCardReturnedRemarks').val(data.idCardReturnedRemarks);
    $('#AccessControlUpdated').val(data.accessControlUpdated);
    $('#AccessControlUpdatedRemarks').val(data.accessControlUpdatedRemarks);
    $('#VisaFeeRecovery').val(data.visaFeeRecovery);
    $('#VisaFeeRecoveryRemarks').val(data.visaFeeRecoveryRemarks);
    $('#TransportDiscontinued').val(data.transportDiscontinued);
    $('#TransportDiscontinuedRemarks').val(data.transportDiscontinuedRemarks);
    $('#AdminSignature').val(data.adminSignature);
    $('#ExitInterview').val(data.exitInterview);
    $('#ExitInterviewRemarks').val(data.exitInterviewRemarks);
    $('#FAndFProcessed').val(data.fAndFProcessed);
    $('#FAndFProcessedRemarks').val(data.fAndFProcessedRemarks);
    $('#TrainingCost').val(data.trainingCost);
    $('#TrainingCostRemarks').val(data.trainingCostRemarks);
    $('#ResignationUpdated').val(data.resignationUpdated);
    $('#ResignationUpdatedRemarks').val(data.resignationUpdatedRemarks);
    $('#NameRemoved').val(data.nameRemoved);
    $('#NameRemovedRemarks').val(data.nameRemovedRemarks);
    $('#InsuranceDiscontinued').val(data.insuranceDiscontinued);
    $('#InsuranceDiscontinuedRemarks').val(data.insuranceDiscontinuedRemarks);
    $('#HrSignature').val(data.hrSignature);
    $('#LoansReturned').val(data.loansReturned);
    $('#LoansReturnedRemarks').val(data.loansReturnedRemarks);
    $('#IncentiveDue').val(data.incentiveDue);
    $('#IncentiveDueRemarks').val(data.incentiveDueRemarks);
    $('#DeductionsDue').val(data.deductionsDue);
    $('#DeductionsDueRemarks').val(data.deductionsDueRemarks);
    $('#TravelFeeDue').val(data.travelFeeDue);
    $('#TravelFeeDueRemarks').val(data.travelFeeDueRemarks);
    $('#TrainingCostDue').val(data.trainingCostDue);
    $('#TrainingCostDueRemarks').val(data.trainingCostDueRemarks);
    $('#VisaFeeDue').val(data.visaFeeDue);
    $('#VisaFeeDueRemarks').val(data.visaFeeDueRemarks);
    $('#AdditionalDeductions').val(data.additionalDeductions);
    $('#AdditionalDeductionsRemarks').val(data.additionalDeductionsRemarks);
    $('#AccountsManagerSignature').val(data.accountsManagerSignature);


                    // Set download button action
                    $('#downloadExitChecklistBtn').off('click').on('click', function () {
                        downloadExitChecklist(data);
                    });

                    // Show the modal
                    $('#exitChecklistModal').modal('show');
                } else {
                    alert("Error: " + response.message);
                }
            },
            error: function () {
                alert("An error occurred while fetching the data.");
            }
        });
    }

    function downloadExitChecklist() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF("p", "mm", "a4"); // Portrait mode, millimeters, A4 size
        let y = 20; // Initial Y position

        // Function to add a section title
        const addSectionTitle = (title) => {
            doc.setFont("helvetica", "bold");
            doc.setFontSize(14);
            doc.text(title, 20, y);
            y += 10;
        };

        // Function to add a table row with Task, Yes/No, and Remarks
        const addTableRow = (task, field, remarksField) => {
            let yesNo = document.getElementById(field)?.value || "N/A";
            let remarks = document.getElementById(remarksField)?.value || "N/A";

            doc.setFont("helvetica", "normal");
            let textLines = doc.splitTextToSize(task, 60); // Task column width

            if (y + (textLines.length * 7) > 280) {
                doc.addPage();
                y = 20;
            }

            doc.text(textLines, 20, y);
            doc.text(90, y, yesNo);
            doc.text(120, y, remarks);
            y += (textLines.length * 7);
        };

        // Employee Information
        doc.setFont("helvetica", "bold");
        doc.setFontSize(16);
        doc.text("Exit Formalities Checklist", 20, y);
        y += 10;
        doc.setFont("helvetica", "normal");
        doc.setFontSize(12);

        const addField = (label, value) => {
            doc.setFont("helvetica", "bold");
            doc.text(label, 20, y);
            doc.setFont("helvetica", "normal");
            doc.text(value || "N/A", 80, y);
            y += 7;
        };

        addField("Employee Name:", document.getElementById("Name")?.value || "N/A");
        addField("Employee ID:", document.getElementById("EmpId")?.value || "N/A");
        addField("Resignation Date:", document.getElementById("ResignationDate")?.value || "N/A");
        addField("Relieving Date:", document.getElementById("RelievingDate")?.value || "N/A");
        addField("Reporting Manager:", document.getElementById("ReportingManager")?.value || "N/A");

        y += 10;

        // Section: Reporting Manager
        addSectionTitle("Reporting Manager");
        addTableRow("Has completed the tasks at hand", "CompletedTasks", "CompletedTasksRemarks");
        addTableRow("Has transferred the knowledge", "KnowledgeTransfer", "KnowledgeTransferRemarks");
        addTableRow("Has returned all assets", "AssetsReturned", "AssetsReturnedRemarks");
        addTableRow("Has returned all documents", "DocumentsReturned", "DocumentsReturnedRemarks");
        addTableRow("Mail Forwarding required", "MailForwarding", "MailForwardingRemarks");
        addTableRow("Mail sent to HR", "MailSentToHR", "MailSentToHRRemarks");

        y += 10;

        // Section: IT Department
        addSectionTitle("IT Department");
        addTableRow("Login ID and Outlook ID withdrawn", "LoginWithdrawn", "LoginWithdrawnRemarks");
        addTableRow("JobDiva Password Reset", "JobdivaReset", "JobdivaResetRemarks");
        addTableRow("Spectra Wi-Fi suspended", "WifiSuspended", "WifiSuspendedRemarks");
        addTableRow("Door Access Suspended", "DoorAccess", "DoorAccessRemarks");
        addTableRow("RingCentral Suspended", "RingcentralSuspended", "RingcentralSuspendedRemarks");
        addTableRow("VOIP Phone Deactivated", "VoipPhoneDeactivated", "VoipPhoneDeactivatedRemarks");
        addTableRow("Client/Job Portal Passwords changed", "ClientPasswordsChanged", "ClientPasswordsChangedRemarks");

        y += 10;

        // Section: Administration
        addSectionTitle("Administration");
        addTableRow("Handed over ID and access card", "IdCardReturned", "IdCardReturnedRemarks");
        addTableRow("Name deleted from access control", "AccessControlUpdated", "AccessControlUpdatedRemarks");
        addTableRow("Visa processing fee to be recovered", "VisaFeeRecovery", "VisaFeeRecoveryRemarks");
        addTableRow("Company Transport discontinued", "TransportDiscontinued", "TransportDiscontinuedRemarks");

        y += 10;

        // Section: Human Resources
        addSectionTitle("Human Resources");
        addTableRow("Exit Interview conducted", "ExitInterview", "ExitInterviewRemarks");
        addTableRow("F&F details sent to Payroll", "FAndFProcessed", "FAndFProcessedRemarks");
        addTableRow("Any Training cost to be recovered", "TrainingCost", "TrainingCostRemarks");
        addTableRow("Resignation details updated", "ResignationUpdated", "ResignationUpdatedRemarks");
        addTableRow("Name removed from website", "NameRemoved", "NameRemovedRemarks");
        addTableRow("Insurance benefit discontinued", "InsuranceDiscontinued", "InsuranceDiscontinuedRemarks");

        y += 10;

        // Section: Accounts
        addSectionTitle("Accounts");
        addTableRow("Returned loans/advance taken", "LoansReturned", "LoansReturnedRemarks");
        addTableRow("Incentive/Bonus due", "IncentiveDue", "IncentiveDueRemarks");
        addTableRow("Deductions due", "DeductionsDue", "DeductionsDueRemarks");
        addTableRow("Amount due from travel/visa", "TravelFeeDue", "TravelFeeDueRemarks");
        addTableRow("Training cost recovery", "TrainingCostDue", "TrainingCostDueRemarks");
        addTableRow("Visa processing fee to be recovered", "VisaFeeDue", "VisaFeeDueRemarks");
        addTableRow("Additional deductions/payments", "AdditionalDeductions", "AdditionalDeductionsRemarks");

        y += 10;

        // Section: Signatures
        addSectionTitle("Signatures");
        addField("Manager Signature:", document.getElementById("ReportingManager0")?.value || "N/A");
        addField("Helpdesk Signature:", document.getElementById("HelpdeskSignature")?.value || "N/A");
        addField("Admin Signature:", document.getElementById("AdminSignature")?.value || "N/A");
        addField("HR Signature:", document.getElementById("HrSignature")?.value || "N/A");
        addField("Accounts Manager Sign:", document.getElementById("AccountsManagerSignature")?.value || "N/A");

        // Save as PDF
        doc.save(`Exit_Checklist_${document.getElementById("Name").value.replace(/\s+/g, "_")}.pdf`);
    }






</script>
